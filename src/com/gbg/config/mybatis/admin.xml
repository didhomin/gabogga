<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.gbg.member.dao.AdminDao">
    <select id="address" parameterType="String" resultType="ListDto">
        select address1
        from guesthouse
        where case	 
        <![CDATA[when address1 < 'ㄱ' then upper(substr(address1, 1, 1))  
			 			when ascii('ㄱ') <= ascii(address1) and ascii(address1)<= ascii('ㅎ') then address1  
			 			when address1 < '나' then 'ㄱ' 
			 			when address1 < '다' then 'ㄴ' 
			 			when address1 < '라' then 'ㄷ' 
			 			when address1 < '마' then 'ㄹ' 
			 			when address1 < '바' then 'ㅁ' 
			 			when address1 < '사' then 'ㅂ' 
			 			when address1 < '아' then 'ㅅ' 
			 			when address1 < '자' then 'ㅇ' 
			 			when address1 < '차' then 'ㅈ' 
			 			when address1 < '카' then 'ㅊ' 
			 			when address1 < '타' then 'ㅋ' 
			 			when address1 < '파' then 'ㅌ' 
			 			when address1 < '하' then 'ㅍ' 
			 			else 'ㅎ' ]]>
			 	end = upper(#{address1}) or address1 like '%'||#{address1}||'%'
    </select>
	
	<select id="main"  resultType="ListDto">
		select address1, gh.guesthouse_id ghId, name gname, room_count roomCount, room_pay roomPay, introduce, lat, lng, picture pictureGh,a.good
		from guesthouse gh
		left outer join (select guesthouse_id,count(*) good
		from house_check hc
		group by guesthouse_id) a on a.guesthouse_id=gh.guesthouse_id
		order by a.good
	</select>
	<select id="mainprice"  resultType="ListDto">
		select gh.guesthouse_id ghId, name gname, room_count roomCount, room_pay roomPay, introduce, lat, lng, picture pictureGh,a.good,room_pay
		from guesthouse gh
		left outer join (select guesthouse_id,count(*) good
		from house_check hc
		group by guesthouse_id) a on a.guesthouse_id=gh.guesthouse_id
		order by room_pay
	</select>
	
</mapper>